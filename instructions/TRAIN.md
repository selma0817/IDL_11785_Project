## Here are some basic instructions/descriptions of the training pipeline. Relevant only if you are training models.

1. `train.py` is the main training file. Run this file to start training. Check the arguments that the parser takes in. (Currently, only cvt is supported.) Remember to change the wandb login id to yours and specify a new wandb run id. By the way, `test.ipynb` is not the testing pipeline! I just use it for debugging purposes.
2. Since each model (swinv2, convnextv2, cvt) uses different models, optimizers, schedulers, criterions, dataloaders (augmentations), and training processes, they are all modularized and called by `train.py`. Specifically, the models are stored in `networks.py`; optimizerss are stored in `optimizers.py`; schedulers are stored in `schedulers.py`; dataloaders are stored in `dataloaders.py`; criterions are stored in `criterions.py` training and testing processes are stored in `trainers.py`. Checkpoints are stored in `checkpoints`
3. Obviously, each architecture has its own hyperparameters. These are stored as an yaml file in `configs`. (Right now only cvt_13_224 is supported.)
4. I tried to use the original implementation of cvt as much as possible. Here are the modifications I've made (not guarantteed to be an exhaustive list): 1) removed all code that enables distributed learning (since we can't do it with single GPUs); 2) changed capitalized config parameters to lowercase (don't ask, it looks better to me stylisticly); 3) changed the number of classes in the final layer of the cvt model (we use imagenet 100 that has 100 classes instead of 1000); 4) added wandb login and printing for the training process; 5) tweaked some timm parameter changes, message me if you are experiencing issues; 6) the hyperparameters are stored in two files in the cvt official website: https://github.com/microsoft/CvT/blob/main/experiments/imagenet/cvt/cvt-13-224x224.yaml. There are default ones in `config/default.py` that applies to all architectures and specific ones in `experiments/imagenet/cvt`. I merged both into a single yaml config file. (If you want to follow the original implementation and have a default file for all yaml configs, feel free to add it.)

If you are adding improvements to the architecture, do the following:
1. Add you new architecture in `networks.py`. Don't just change the original implementation in there!
2. If you want to customize optimizers/schedulers/trainers etc., go to the corresponding files and add your own. Again, don't change the original implementations.
3. Add you own yaml config file in `configs`. Copy the config file I created called `cvt_13_224.yaml` and modify hyperparameters there (should be all hyperparameters relevant).
4. You might need to change directory paths depending on where you stored your data and configs.
5. Message me on weichat if there are problems that you can't solve in less than 15min. Call/facetime me if I don't respond.
